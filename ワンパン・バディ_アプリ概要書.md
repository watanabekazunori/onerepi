# ワンパン・バディ（Onerepi）アプリ概要書

**最終更新日**: 2026年1月23日
**バージョン**: 1.0.0
**デプロイURL**: https://onerepi.vercel.app

---

## 1. アプリ概要

### 1.1 コンセプト
「ワンパン・バディ」は、**自炊初心者やワンオペ家庭向け**の週間献立・買い物管理アプリです。「フライパン1つで完結」をコンセプトに、料理のハードルを下げ、日々の食事準備を効率化します。

### 1.2 ターゲットユーザー
- 自炊初心者
- 一人暮らし・共働き家庭
- 料理に時間をかけたくないが健康的な食事を摂りたい人
- 献立を考えるのが面倒な人

### 1.3 主な価値提案
- **心理タイプ診断**による個人最適化された献立提案
- **週間献立の自動生成**（食材の使い回し最適化）
- **買い物リストの自動生成**
- **調理ガイド**（ステップバイステップ、タイマー付き）

---

## 2. 技術スタック

### 2.1 フロントエンド
| 技術 | バージョン | 用途 |
|------|-----------|------|
| React Native | 0.81.5 | クロスプラットフォームUI |
| Expo | 54.0.31 | 開発・ビルド環境 |
| TypeScript | 5.9.2 | 型安全性 |
| React Navigation | 7.x | 画面遷移管理 |
| Lucide React Native | 0.562.0 | アイコン |

### 2.2 状態管理・データ
| 技術 | 用途 |
|------|------|
| AsyncStorage | ローカルデータ永続化 |
| Supabase | バックエンド（認証・DB）※準備中 |

### 2.3 デプロイ
| 環境 | 技術 |
|------|------|
| Web | Vercel（Expo Web） |
| iOS/Android | Expo Go / EAS Build（予定） |

---

## 3. 主要機能

### 3.1 心理タイプ診断システム

ユーザーの食に対する心理傾向を5つのタイプに分類し、パーソナライズされた献立を提案します。

#### 5つの心理タイプ
| タイプ | 名前 | 特徴 | キーワード |
|--------|------|------|-----------|
| ⚖️ | スマート・バランサー | 効率重視の合理派 | 時短、作り置き、栄養バランス |
| 💪 | ストイック・クリエイター | 健康志向の自己実現派 | 高タンパク、低糖質、ヘルシー |
| 🍲 | ヒーリング・グルマン | 癒し重視の安定派 | ほっこり、家庭料理、懐かしい味 |
| ✨ | トレンド・ハンター | エンタメ重視の探求派 | 映え、エスニック、スパイス |
| 🎭 | フレキシブル・フーディー | 状況対応の柔軟派 | 臨機応変、バランス |

#### 診断ロジック
- **2軸マトリクス**: 機能/快楽 × 安定/探求
- **5問A/B形式**の質問で判定
- 診断結果に基づいて週間献立の構成比率を調整

### 3.2 週間献立生成

#### 生成ロジック
```
心理タイプ × 信頼度 → ミックス設定
  ↓
7日分のスロットタイプ決定（universal / type_specific / adventure）
  ↓
各日のレシピをスコアリング・選択
  ↓
食材使い回し最適化
```

#### スロット構成例（信頼度50%の場合）
- **万人向け（universal）**: 3日
- **タイプ別（type_specific）**: 3日
- **冒険枠（adventure）**: 1日

### 3.3 レシピスコアリング

レシピ選択時のスコア要素：
- 心理タイプとの適合度
- カテゴリバランス（和・洋・中・アジアン）
- 食材の使い回し効率
- 最近作ったレシピの除外
- 調理時間の適正度

### 3.4 調理ガイド

- ステップバイステップ表示
- 各工程のタイマー機能
- 音声読み上げ対応
- 調理後フィードバック（学習に活用）

---

## 4. 画面構成

### 4.1 ナビゲーション構造

```
Root Stack
├── Welcome（オンボーディング開始）
├── OnboardingSlides（機能紹介）
├── Setup（初期設定）
├── Auth（認証）
├── Onboarding（チャット形式設定）※レガシー
│
├── MainTabs（メインタブ）
│   ├── 献立（WeeklyPlan）
│   ├── 買い物（ShoppingList）
│   ├── 日記（CookingLog）
│   ├── タイプ（MyType）★新規追加
│   └── 設定（Profile）
│
├── Modal Screens
│   ├── DraftMeeting（献立会議）
│   ├── Cooking（調理ガイド）
│   ├── AIChat（AIチャット）
│   ├── PreferenceDiagnosis（心理タイプ診断）
│   └── CookingFeedback（調理後フィードバック）
│
└── Detail Screens
    ├── RecipeList
    ├── RecipeDetail
    ├── Inventory
    ├── Favorites
    ├── AIRecipe
    └── MyType
```

### 4.2 主要画面

| 画面 | ファイル | 概要 |
|------|---------|------|
| 週間献立 | WeeklyPlanScreen.tsx | 今週の献立一覧、ドラフト会議起動 |
| 献立会議 | DraftMeetingScreen.tsx | AI対話形式で週間献立を決定 |
| 買い物リスト | ShoppingListScreen.tsx | 自動生成された買い物リスト |
| 調理ガイド | CookingScreen.tsx | ステップバイステップ調理 |
| 心理診断 | PreferenceDiagnosisScreen.tsx | 5問A/B形式の診断 |
| マイタイプ | MyTypeScreen.tsx | 診断結果・タイプ詳細表示 |
| 設定 | ProfileScreen.tsx | プロフィール・各種設定 |

---

## 5. データモデル

### 5.1 ユーザー設定（UserPreferences）
```typescript
interface UserPreferences {
  name: string;
  household: number;           // 世帯人数
  tastePreferences: string[];  // 味の好み
  healthGoals: string[];       // 健康目標
  dislikes: string[];          // 苦手食材
  allergies: string[];         // アレルギー
  cookingSkill: string;        // 料理スキル
  kitchenEquipment: string[];  // キッチン設備
  pantrySeasonings: string[];  // 常備調味料
  diagnosisAnswers?: {         // 心理診断結果
    psychologyType: FoodPsychologyType;
    rawAnswers: DiagnosisAnswer[];
    purposeScore: number;
    adventureScore: number;
  };
  diagnosisCompletedAt?: string;
}
```

### 5.2 レシピ（Recipe）
```typescript
interface Recipe {
  id: string;
  name: string;
  emoji: string;
  description: string;
  cooking_time_minutes: number;
  difficulty: 'easy' | 'medium' | 'hard';
  category: 'japanese' | 'western' | 'chinese' | 'asian' | 'other';
  ingredients: Ingredient[];
  steps: CookingStep[];
  tags: string[];
  servings: number;
  is_bento_friendly: boolean;
  nutrition?: NutritionInfo;
}
```

### 5.3 週間献立（WeeklyPlan）
```typescript
interface WeeklyPlan {
  id: string;
  user_id: string;
  date: string;           // YYYY-MM-DD
  recipe_id: string;
  recipe?: Recipe;
  meal_type: 'breakfast' | 'lunch' | 'dinner';
  status: 'planned' | 'cooked' | 'skipped';
  scale_factor: number;   // 倍量調整
  is_for_bento: boolean;
  sideDish?: {            // 副菜
    recipeId: string;
    recipe: Recipe;
    reason: string;
  };
}
```

---

## 6. コアロジック

### 6.1 ファイル構成

```
src/lib/
├── preferenceScoring.ts     # 心理タイプ定義・診断ロジック
├── userTypeLearning.ts      # タイプ学習・進化ロジック
├── weeklyPlanGenerator.ts   # 週間献立生成アルゴリズム
├── sideDishSuggester.ts     # 副菜提案ロジック
├── preferenceLearner.ts     # 好み学習（フィードバック反映）
├── storage.ts               # AsyncStorageラッパー
├── mockData.ts              # モックレシピデータ
├── supabase-service.ts      # Supabase接続
└── theme.ts                 # UIテーマ定義
```

### 6.2 タイプ学習システム

```typescript
// 学習プロファイル
interface UserLearningProfile {
  userId: string;
  diagnosedType: FoodPsychologyType;
  learningHistory: LearningEvent[];
  typeConfidence: Record<FoodPsychologyType, number>;
  currentMixRatio: WeeklyMixConfig;
}

// 学習イベント
interface LearningEvent {
  recipeId: string;
  action: 'cooked' | 'skipped' | 'replaced' | 'rated';
  recipeClassification: RecipeTypeClassification;
  feedback?: { rating: number; liked: boolean };
  timestamp: string;
}
```

#### 信頼度による献立調整
| 信頼度 | 万人向け | タイプ別 | 冒険 |
|--------|---------|---------|------|
| 0%（初期） | 5日 | 2日 | 0日 |
| 50% | 3日 | 3日 | 1日 |
| 100% | 2日 | 4日 | 1日 |

---

## 7. 今後の開発予定

### 7.1 短期（1-2ヶ月）
- [ ] Supabase認証・データ同期の実装
- [ ] 心理診断のスクロール・アニメーション修正
- [ ] レシピデータの拡充（50→200品目標）
- [ ] 調理フィードバックの学習反映

### 7.2 中期（3-6ヶ月）
- [ ] AI食材認識（カメラで冷蔵庫撮影→レシピ提案）
- [ ] カレンダー連携（調理予定のリマインダー）
- [ ] 家族メンバー管理
- [ ] レシピ共有・コミュニティ機能

### 7.3 長期
- [ ] iOS/Androidネイティブアプリ公開
- [ ] 有料プラン（プレミアムレシピ、AI機能強化）
- [ ] スーパー特売情報連携

---

## 8. コード統計

| 項目 | 数値 |
|------|------|
| ソースファイル数 | 56ファイル |
| 総コード行数 | 約26,500行 |
| 画面数 | 23画面 |
| UIコンポーネント | 12個 |
| レシピ数（モック） | 30品 |

---

## 9. 参考リンク

- **本番URL**: https://onerepi.vercel.app
- **GitHubリポジトリ**: （要設定）
- **Figmaデザイン**: （要設定）

---

## 10. 他AIへの相談用プロンプト例

### 心理タイプシステムについて相談する場合
```
食に関する心理タイプ分類システムを実装しています。
現在5タイプ（スマート・バランサー、ストイック・クリエイター、
ヒーリング・グルマン、トレンド・ハンター、フレキシブル・フーディー）
で2軸マトリクス（機能/快楽×安定/探求）による分類を行っています。

[具体的な相談内容]
```

### 献立生成ロジックについて相談する場合
```
週間献立自動生成システムを実装しています。
ユーザーの心理タイプと学習履歴に基づいて、
「万人向け」「タイプ別」「冒険枠」の3種類のスロットに
レシピを割り当てるアルゴリズムです。

[具体的な相談内容]
```

### UIUXについて相談する場合
```
React Native + Expoで献立管理アプリを開発しています。
ターゲットは自炊初心者で、「フライパン1つ」がコンセプトです。
現在の画面構成は：献立、買い物、日記、タイプ、設定の5タブです。

[具体的な相談内容]
```

---

*この概要書は開発の現状を記録したものです。詳細な実装についてはソースコードを参照してください。*
